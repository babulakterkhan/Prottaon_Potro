<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <title>BCTI - ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶è‡¶°‡¶ø‡¶∂‡¶®</title>
    
    <!-- ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶´‡¶®‡ßç‡¶ü ‡¶≤‡¶ø‡¶Ç‡¶ï -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&family=Noto+Serif+Bengali:wght@100..900&family=Baloo+Da2:wght@400..800&family=Galada&family=Kalpurush&family=Siyam+Rupali&family=Solaiman+Lipi&family=Nikosh&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary: #004d40; --accent: #00695c; }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #eaeff2; margin: 0; padding: 0; display: flex; height: 100vh; overflow: hidden; }
        
        .input-panel { width: 380px; background: #fff; box-shadow: 2px 0 10px rgba(0,0,0,0.1); overflow-y: auto; border-right: 3px solid var(--primary); display: flex; flex-direction: column; }
        .panel-header { background: var(--primary); color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .panel-header h2 { margin: 0; font-size: 18px; }
        .panel-section { padding: 20px; flex: 1; }
        .section-title { color: var(--primary); font-size: 15px; border-bottom: 1px solid #ddd; padding-bottom: 5px; margin: 15px 0 10px 0; font-weight: bold; text-transform: uppercase; }

        #masterSettings { display: none; background: #f0f4f3; border-bottom: 5px solid #ddd; padding: 20px; border-left: 5px solid var(--primary); }
        .input-group { margin-bottom: 12px; }
        .input-group label { display: block; font-weight: bold; margin-bottom: 4px; font-size: 13px; color: #555; }
        .input-group input, .input-group select, .input-group textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-family: inherit; font-size: 14px; }

        .slider-group { margin-bottom: 12px; }
        .slider-group label { display: block; font-weight: bold; margin-bottom: 4px; font-size: 13px; color: #555; }
        .slider-container { display: flex; align-items: center; gap: 10px; }
        .slider-container input[type="range"] { flex: 1; }
        .slider-value { min-width: 30px; text-align: center; font-weight: bold; }

        .backup-tools { display: flex; gap: 8px; margin-top: 15px; border-top: 1px solid #ccc; padding-top: 15px; }
        .btn-sm { flex: 1; padding: 8px; font-size: 12px; cursor: pointer; border-radius: 4px; border: 1px solid #999; background: #fff; font-weight: bold; text-align: center; }

        .preview-panel { flex: 1; background: #525659; display: flex; justify-content: center; align-items: flex-start; padding: 30px; overflow-y: auto; }
        .certificate { width: 210mm; min-height: 297mm; background: white; box-shadow: 0 0 20px rgba(0,0,0,0.4); box-sizing: border-box; position: relative; }
        
        .pad-mode-on .header-area { display: none !important; }

        .header-area { 
            display: grid; 
            grid-template-columns: 100px 1fr 100px; 
            align-items: center; 
            border-bottom: 3px solid var(--primary); 
            margin-bottom: 30px; 
            padding-bottom: 20px;
            margin-left: -70px;
            margin-right: -70px;
            padding-left: 30px;
            padding-right: 30px;
            width: auto;
            box-sizing: border-box;
        }
        .logo-box { width: 90px; height: 90px; display: flex; align-items: center; justify-content: center; }
        .logo-box img { max-width: 100%; max-height: 90px; object-fit: contain; }
        
        .header-text { text-align: center; }
        
        .office-name {
            font-size: 20px;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 5px;
            letter-spacing: 1px;
        }
        
        .header-text h1 { margin: 0; font-size: 28px; font-weight: bold; color: var(--primary); }
        .estd-text { font-size: 14px; margin: 2px 0; color: #444; font-weight: bold; display: block; }
        .header-text p { margin: 5px 0 2px; font-size: 15px; color: #333; }
        
        .contact-info { display: flex; flex-direction: column; align-items: center; gap: 2px; margin-top: 5px; }
        .contact-info span { font-size: 13px; color: var(--accent); font-weight: 500; }

        .meta-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0 30px 0;
            font-size: 18px;
            font-weight: normal;
            padding: 0 10px;
        }
        .meta-dak {
            text-align: left;
            flex: 1;
        }
        .meta-date {
            text-align: right;
            flex: 1;
        }
        .meta-label {
            font-weight: bold;
            color: var(--primary);
        }
        .meta-value {
            font-weight: normal;
            color: #000;
            border-bottom: 1px dotted #999;
            padding: 0 5px;
        }

        .header-lines {
            line-height: 1.2;
        }

        .body-content {
            margin-top: 0px;
        }

        .title { text-align: center; margin: 20px 0 40px 0; }
        .title span { font-size: 26px; font-weight: bold; color: #fff; background: var(--primary); padding: 5px 35px; border-radius: 50px; }

        .content { font-size: 20px; text-align: justify; color: #000; }
        .content p { margin: 0 0 15px 0; } 
        .data-text { font-weight: normal; color: #000; border-bottom: 1px dotted #999; }

        .footer { 
            margin-top: 80px; 
            display: flex; 
            justify-content: space-between; 
            align-items: flex-end; 
        }
        
        /* ‡¶∏‡¶á ‡¶ì ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶®‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø‡ßá‡¶∞ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
        .signature-block {
            text-align: center;
            width: 300px;
        }
        .signature-line {
            border-top: 2px solid var(--primary);
            width: 0%;
            margin-bottom: 5px;
        }
        .teacher-name {
            font-size: 15px;
            font-weight: bold;
            color: #000;
            margin: 5px 0 2px 0;
        }
        .teacher-title {
            font-size: 16px;
            font-weight: normal;
            color: var(--primary);
            margin-bottom: 10px;
        }
        .school-name-footer {
            font-size: 16px;
            font-weight: normal;
            color: #000;
            margin: 2px 0;
        }
        .school-address-footer {
            font-size: 16px;
            color: #000;
            margin: 2px 0;
        }

        .btn { padding: 12px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; color: white; width: 100%; }
        .btn-settings { background: #555; padding: 6px 12px; font-size: 12px; width: auto; }
        .btn-print { background: var(--primary); margin-top: 10px; font-size: 16px; }

        @media print {
            .input-panel, .btn-print, .btn-settings {
                display: none !important;
            }
            
            .preview-panel {
                padding: 0 !important;
                background: white !important;
                display: flex !important;
                justify-content: center !important;
                align-items: center !important;
                height: 100vh !important;
                overflow: hidden !important;
            }
            
            .certificate {
                box-shadow: none !important;
                border: none !important;
                width: 210mm !important;
                height: 297mm !important;
                margin: 0 auto !important;
                box-sizing: border-box !important;
                overflow: hidden !important;
                page-break-after: avoid !important;
                page-break-inside: avoid !important;
            }
            
            .data-text, .meta-value {
                border-bottom: none !important;
            }
            
            .title span {
                background: var(--primary) !important;
                color: white !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .header-text h1 {
                color: var(--primary) !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            @page {
                size: A4 portrait;
                margin: 0;
            }
        }
    </style>
</head>
<body onload="autoLoad()">

<div class="input-panel">
    <div class="panel-header">
        <h2>BCTI ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</h2>
        <button class="btn btn-settings" onclick="checkPass()">‚öôÔ∏è ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</button>
    </div>

    <div id="masterSettings">
        <div class="section-title">‚öôÔ∏è ‡¶Æ‡¶æ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</div>
        <div class="input-group"><label>üîí ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°</label><input type="password" id="setPass" onblur="save()"></div>
        <hr>
        <div class="input-group"><label>‡¶≤‡ßã‡¶ó‡ßã ‡¶Ü‡¶™‡¶≤‡ßã‡¶°</label><input type="file" accept="image/*" onchange="updateLogo(this)"></div>
        
        <div class="input-group">
            <label>üìã ‡¶™‡¶¶‡¶¨‡ßÄ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®</label>
            <select id="inSignTitle" onchange="sync()">
                <option value="‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï">‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï</option>
                <option value="‡¶Ö‡¶ß‡ßç‡¶Ø‡¶ï‡ßç‡¶∑">‡¶Ö‡¶ß‡ßç‡¶Ø‡¶ï‡ßç‡¶∑</option>
                <option value="‡¶Ö‡¶ß‡ßç‡¶Ø‡¶ï‡ßç‡¶∑/‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï">‡¶Ö‡¶ß‡ßç‡¶Ø‡¶ï‡ßç‡¶∑/‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï</option>
                <option value="‡¶Ö‡¶ß‡ßç‡¶Ø‡¶ï‡ßç‡¶∑ (‡¶≠‡¶æ‡¶∞‡¶™‡ßç‡¶∞‡¶æ‡¶™‡ßç‡¶§)">‡¶Ö‡¶ß‡ßç‡¶Ø‡¶ï‡ßç‡¶∑ (‡¶≠‡¶æ‡¶∞‡¶™‡ßç‡¶∞‡¶æ‡¶™‡ßç‡¶§)</option>
            </select>
        </div>
        
        <!-- ‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ -->
        <div class="input-group"><label>üë§ ‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</label><input type="text" id="inTeacherName" oninput="sync()" value=""></div>
        
        <div class="input-group"><label>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶®‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</label><input type="text" id="inShop" oninput="sync()" value="‡¶Æ‡¶ì‡¶≤‡¶æ‡¶®‡¶æ ‡¶õ‡¶æ‡¶á‡¶´ ‡¶â‡¶¶‡ßç‡¶¶‡¶ø‡¶® ‡¶è‡¶π‡¶ø‡ßü‡¶æ ‡¶â‡¶ö‡ßç‡¶ö ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡ßü"></div>
        
        <div class="slider-group">
            <label>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶®‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú</label>
            <div class="slider-container">
                <input type="range" id="shopNameSize" min="16" max="48" value="28" oninput="updateShopSize(this.value)" onchange="save()">
                <span id="shopSizeValue" class="slider-value">28px</span>
            </div>
        </div>
        
        <div class="slider-group">
            <label>‡¶Ö‡¶´‡¶ø‡¶∏‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú</label>
            <div class="slider-container">
                <input type="range" id="officeNameSize" min="12" max="32" value="20" oninput="updateOfficeNameSize(this.value)" onchange="save()">
                <span id="officeNameValue" class="slider-value">20px</span>
            </div>
        </div>
        
        <div class="slider-group">
            <label>‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ‡¶∞ ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú</label>
            <div class="slider-container">
                <input type="range" id="addressSize" min="10" max="20" value="15" oninput="updateAddressSize(this.value)" onchange="save()">
                <span id="addressSizeValue" class="slider-value">15px</span>
            </div>
        </div>
        
        <div class="slider-group">
            <label>‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ‡ßá‡¶∞ ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú</label>
            <div class="slider-container">
                <input type="range" id="dateSize" min="10" max="24" value="16" oninput="updateDateSize(this.value)" onchange="save()">
                <span id="dateSizeValue" class="slider-value">16px</span>
            </div>
        </div>
        
        <div class="slider-group">
            <label>‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡ßü‡¶® ‡¶™‡¶§‡ßç‡¶∞ ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤‡ßá‡¶∞ ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú</label>
            <div class="slider-container">
                <input type="range" id="titleSize" min="18" max="40" value="26" oninput="updateTitleSize(this.value)" onchange="save()">
                <span id="titleSizeValue" class="slider-value">26px</span>
            </div>
        </div>

        <div class="slider-group">
            <label>üìè ‡¶¨‡¶°‡¶ø‡¶∞ ‡¶≤‡¶æ‡¶á‡¶® ‡¶ó‡ßç‡¶Ø‡¶æ‡¶™</label>
            <div class="slider-container">
                <input type="range" id="lineGap" min="0.5" max="3.0" step="0.1" value="2.2" oninput="updateLineGap(this.value)" onchange="save()">
                <span id="lineGapValue" class="slider-value">2.2</span>
            </div>
        </div>

        <div class="slider-group">
            <label>üìè ‡¶π‡ßá‡¶°‡¶æ‡¶∞‡ßá‡¶∞ ‡¶≤‡¶æ‡¶á‡¶® ‡¶ó‡ßç‡¶Ø‡¶æ‡¶™</label>
            <div class="slider-container">
                <input type="range" id="headerLineGap" min="0.8" max="2.5" step="0.1" value="1.2" oninput="updateHeaderLineGap(this.value)" onchange="save()">
                <span id="headerLineGapValue" class="slider-value">1.2</span>
            </div>
        </div>
        
        <div class="input-group">
            <label>üé® ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶´‡¶®‡ßç‡¶ü ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®</label>
            <select id="fontFamily" onchange="updateFontFamily(this.value)">
                <option value="'Segoe UI', Arial, sans-serif">Segoe UI (‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü)</option>
                <option value="'Hind Siliguri', sans-serif">Hind Siliguri</option>
                <option value="'Noto Serif Bengali', serif">Noto Serif Bengali</option>
                <option value="'Baloo Da 2', cursive">Baloo Da 2</option>
                <option value="'Galada', cursive">Galada</option>
                <option value="'Kalpurush', Arial, sans-serif">‡¶ï‡¶æ‡¶≤‡¶™‡ßÅ‡¶∞‡ßÅ‡¶∑</option>
                <option value="'Siyam Rupali', Arial, sans-serif">‡¶∏‡¶ø‡ßü‡¶æ‡¶Æ ‡¶∞‡ßÇ‡¶™‡¶æ‡¶≤‡ßÄ</option>
                <option value="'SolaimanLipi', Arial, sans-serif">‡¶∏‡¶≤‡¶ø‡¶Æ‡¶æ‡¶® ‡¶≤‡¶ø‡¶™‡¶ø</option>
                <option value="'Nikosh', Arial, sans-serif">‡¶®‡¶ø‡¶ï‡ßã‡¶∂</option>
                <option value="Arial, sans-serif">Arial</option>
                <option value="'Times New Roman', serif">Times New Roman</option>
                <option value="'Courier New', monospace">Courier New</option>
                <option value="'Georgia', serif">Georgia</option>
                <option value="'Tahoma', sans-serif">Tahoma</option>
                <option value="'Verdana', sans-serif">Verdana</option>
                <option value="'Poppins', sans-serif">Poppins</option>
                <option value="'Roboto', sans-serif">Roboto</option>
                <option value="'Open Sans', sans-serif">Open Sans</option>
            </select>
        </div>
        
        <div style="font-size:12px; color:#666; margin-top:5px; padding:5px; background:#f9f9f9; border-radius:3px;">
            ‚ö° ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶´‡¶®‡ßç‡¶ü ‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶≤‡ßã‡¶° ‡¶π‡ßü, ‡¶§‡¶æ‡¶á ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá
        </div>
        
        <div class="input-group"><label>‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶ø‡¶§</label><input type="text" id="inEstd" oninput="sync()" value="‡ßß‡ßØ‡ßØ‡ß™"></div>
        <div class="input-group"><label>‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ ‡¶ì ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤</label><textarea id="inAddr" rows="1" oninput="sync()">‡¶∂‡¶æ‡¶π‡¶ú‡¶æ‡¶¶‡¶™‡ßÅ‡¶∞, ‡¶∏‡¶ø‡¶∞‡¶æ‡¶ú‡¶ó‡¶û‡ßç‡¶ú, ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤: ‡ß¶‡ßß‡ß©‡ß¶‡ßØ-‡ßß‡ß®‡ßÆ‡ß®‡ßÆ‡ß´</textarea></div>
        <div style="display: flex; gap: 8px;">
            <div class="input-group" style="flex:1;"><label>‡¶á‡¶Æ‡ßá‡¶á‡¶≤</label><input type="text" id="inEmail" oninput="sync()" value="babulcomputer@gmail.com"></div>
            <div class="input-group" style="flex:1;"><label>‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü</label><input type="text" id="inWeb" oninput="sync()" value="www.msuashschool.edu.bd"></div>
        </div>

        <div class="section-title">üìè ‡¶´‡¶®‡ßç‡¶ü ‡¶ì ‡¶á‡¶®‡¶°‡ßá‡¶®‡ßç‡¶ü</div>
        <div style="display: flex; gap: 8px;">
            <div class="input-group" style="flex:1;"><label>‡¶Æ‡ßÇ‡¶≤ ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú</label><input type="number" id="setFontSize" value="20" oninput="sync()"></div>
            <div class="input-group" style="flex:1;"><label>‡¶™‡ßç‡¶Ø‡¶æ‡¶∞‡¶æ ‡¶á‡¶®‡¶°‡ßá‡¶®‡ßç‡¶ü</label><input type="number" id="setIndent" value="0" oninput="sync()"></div>
        </div>
        <div style="display: flex; gap: 8px;">
            <div class="input-group" style="flex:1;"><label>‡¶∏‡ßç‡¶¨‡¶æ‡¶ï‡ßç‡¶∑‡¶∞ ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú</label><input type="number" id="setSignSize" value="18" oninput="sync()"></div>
        </div>
        
        <div class="section-title">üìê ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶®‡¶ø‡ßü‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£</div>
        
        <div class="slider-group">
            <label>üìå ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡¶ï-‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ‡ßá‡¶∞ ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶®</label>
            <div class="slider-container">
                <input type="range" id="metaTopMargin" min="-50" max="150" value="20" oninput="updateMetaMargin(this.value)" onchange="save()">
                <span id="metaTopValue" class="slider-value">20px</span>
            </div>
        </div>
        
        <div class="slider-group">
            <label>üî§ ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡¶ï-‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ‡ßá‡¶∞ ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú</label>
            <div class="slider-container">
                <input type="range" id="metaFontSize" min="12" max="28" value="18" oninput="updateMetaFontSize(this.value)" onchange="save()">
                <span id="metaFontValue" class="slider-value">18px</span>
            </div>
        </div>
        
        <div class="slider-group">
            <label>üìÑ ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤ ‡¶ì ‡¶¨‡¶°‡¶ø‡¶∞ ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶®</label>
            <div class="slider-container">
                <input type="range" id="bodyTopMargin" min="0" max="150" value="0" oninput="updateBodyMargin(this.value)" onchange="save()">
                <span id="bodyTopValue" class="slider-value">0px</span>
            </div>
        </div>
        
        <div class="slider-group">
            <label>üìå ‡¶π‡ßá‡¶°‡¶æ‡¶∞‡ßá‡¶∞ ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶®</label>
            <div class="slider-container">
                <input type="range" id="headerTopMargin" min="0" max="100" value="0" oninput="updateHeaderMargin(this.value)" onchange="save()">
                <span id="headerTopValue" class="slider-value">0px</span>
            </div>
        </div>
        
        <div style="display: flex; gap: 5px; margin-top: 10px;">
            <div class="input-group" style="flex:1;"><label>‡¶â‡¶™‡¶∞</label><input type="number" id="mTop" value="100" oninput="sync()"></div>
            <div class="input-group" style="flex:1;"><label>‡¶®‡¶ø‡¶ö</label><input type="number" id="mBottom" value="50" oninput="sync()"></div>
            <div class="input-group" style="flex:1;"><label>‡¶¨‡¶æ‡¶Æ</label><input type="number" id="mLeft" value="75" oninput="sync()"></div>
            <div class="input-group" style="flex:1;"><label>‡¶°‡¶æ‡¶®</label><input type="number" id="mRight" value="75" oninput="sync()"></div>
        </div>

        <div class="section-title">üìù ‡¶Æ‡¶æ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü</div>
        <div class="input-group"><label>‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ/‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ (‡¶ï‡¶Æ‡¶æ ‡¶¶‡¶ø‡ßü‡ßá) - ‡¶∂‡¶æ‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø - ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ø‡ßá‡¶Æ‡¶®: ‡ß¨‡¶∑‡ßç‡¶†-‡¶ï,‡ß¨‡¶∑‡ßç‡¶†-‡¶ñ,‡ß≠‡¶Æ-‡¶ï,‡ß≠‡¶Æ-‡¶ñ</label><input type="text" id="setCls" onblur="updateMasterLists()" value="‡ß¨‡¶∑‡ßç‡¶†-‡¶ï,‡ß¨‡¶∑‡ßç‡¶†-‡¶ñ,‡ß≠‡¶Æ-‡¶ï,‡ß≠‡¶Æ-‡¶ñ,‡ßÆ‡¶Æ-‡¶ï,‡ßÆ‡¶Æ-‡¶ñ,‡ßØ‡¶Æ,‡ßß‡ß¶‡¶Æ"></div>
        <div class="input-group"><label>‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó (‡¶ï‡¶Æ‡¶æ ‡¶¶‡¶ø‡ßü‡ßá)</label><input type="text" id="setDept" onblur="updateMasterLists()" value="‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶®,‡¶Æ‡¶æ‡¶®‡¶¨‡¶ø‡¶ï,‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ‡ßü ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ"></div>
        <div class="input-group"><label>‡¶∏‡ßá‡¶∂‡¶® (‡¶ï‡¶Æ‡¶æ ‡¶¶‡¶ø‡ßü‡ßá)</label><input type="text" id="setSession" onblur="updateMasterLists()" value="‡ß®‡ß¶‡ß®‡ß™,‡ß®‡ß¶‡ß®‡ß´,‡ß®‡ß¶‡ß®‡ß¨"></div>
        <div class="input-group"><label>‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ (‡¶ï‡¶Æ‡¶æ ‡¶¶‡¶ø‡ßü‡ßá)</label><input type="text" id="setUpz" onblur="updateMasterLists()" value="‡¶∂‡¶æ‡¶π‡¶ú‡¶æ‡¶¶‡¶™‡ßÅ‡¶∞"></div>
        <div class="input-group"><label>‡¶ú‡ßá‡¶≤‡¶æ (‡¶ï‡¶Æ‡¶æ ‡¶¶‡¶ø‡ßü‡ßá)</label><input type="text" id="setDist" onblur="updateMasterLists()" value="‡¶∏‡¶ø‡¶∞‡¶æ‡¶ú‡¶ó‡¶û‡ßç‡¶ú"></div>
        
        <div class="input-group"><label>üìã ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡¶ï ‡¶®‡¶Ç</label><input type="text" id="inDak" oninput="sync()" value="‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡ßü/‡¶∏‡¶¶‡¶∞/‡ß®‡ß¶‡ß®‡ß™/‡ßß‡ß®‡ß©"></div>

        <div class="backup-tools">
            <button class="btn-sm" onclick="exportJSON()">üì• ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™</button>
            <button class="btn-sm" onclick="document.getElementById('importFile').click()">üì§ ‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞</button>
            <input type="file" id="importFile" style="display:none" accept=".json" onchange="importJSON(this)">
        </div>
        <button class="btn" style="background:#777; font-size:12px; margin-top:15px;" onclick="toggleSettings()">‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>

    <div class="panel-section">
        <div class="section-title">üë§ ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶∞‡ßç‡¶•‡ßÄ‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø</div>
        <div class="input-group"><label>‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶∞‡ßç‡¶•‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ</label><input type="text" id="inName" oninput="sync()" value="‡¶Ü‡¶¨‡ßÅ‡¶≤ ‡¶π‡¶æ‡¶ï‡¶ø‡¶Æ"></div>
        <div style="display: flex; gap: 8px;">
            <div class="input-group" style="flex:1;"><label>‡¶™‡¶ø‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ</label><input type="text" id="inFather" oninput="sync()" value="‡¶Ü‡¶π‡¶æ‡¶¶‡ßÅ‡¶≤ ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ"></div>
            <div class="input-group" style="flex:1;"><label>‡¶Æ‡¶æ‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ</label><input type="text" id="inMother" oninput="sync()" value="‡¶∏‡¶æ‡¶≤‡¶Æ‡¶æ ‡¶ñ‡¶æ‡¶§‡ßÅ‡¶®"></div>
        </div>
        <div class="input-group"><label>‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ/‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ</label><input type="text" id="inVill" oninput="sync()" value="‡¶∂‡ßá‡¶∞‡¶ñ‡¶æ‡¶≤‡ßÄ"></div>
        <div style="display: flex; gap: 8px;">
            <div class="input-group" style="flex:1;"><label>‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ</label>
                <select id="inUpz" onchange="sync()"></select>
            </div>
            <div class="input-group" style="flex:1;"><label>‡¶ú‡ßá‡¶≤‡¶æ</label>
                <select id="inDist" onchange="sync()"></select>
            </div>
        </div>
        <div style="display: flex; gap: 8px;">
            <div class="input-group" style="flex:1;"><label>‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ/‡¶ï‡ßç‡¶≤‡¶æ‡¶∏</label>
                <select id="inCls" onchange="sync()"></select>
            </div>
            <div class="input-group" style="flex:1;">
                <label>‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó (‡¶®‡¶ø‡¶ú‡ßá ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®)</label>
                <input type="text" id="inDept" oninput="sync()" value="‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶®" placeholder="‡¶Ø‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">
            </div>
        </div>
        <div style="display: flex; gap: 8px;">
            <div class="input-group" style="flex:1;"><label>‡¶∏‡ßá‡¶∂‡¶®</label>
                <select id="inSession" onchange="sync()"></select>
            </div>
            <div class="input-group" style="flex:1;"><label>‡¶∞‡ßã‡¶≤</label><input type="text" id="inRoll" oninput="sync()" value="‡ßß‡ß¶"></div>
        </div>
        <div class="input-group"><label>‡¶ú‡¶®‡ßç‡¶Æ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</label><input type="text" id="inDOB" oninput="sync()" value="‡ßß‡ß¨/‡ßß‡ßß/‡ßß‡ßØ‡ß¨‡ßÆ"></div>
        <div style="margin: 15px 0;"><label style="cursor:pointer; font-weight: bold; color: #d32f2f;"><input type="checkbox" id="padMode" onchange="sync()"> ‡¶™‡ßç‡¶Ø‡¶æ‡¶°‡ßá ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü (‡¶π‡ßá‡¶°‡¶æ‡¶∞ ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®)</label></div>
        <button class="btn btn-print" onclick="window.print()">üñ®Ô∏è ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>
</div>

<div class="preview-panel">
    <div id="certArea" class="certificate">
        <div class="header-area" id="headerSection">
            <div class="logo-box"><img id="certLogo" src="https://via.placeholder.com/90?text=LOGO"></div>
            <div class="header-text">
                <div class="header-lines" id="headerLines">
                    <div class="office-name" id="outOfficeName">‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï‡ßá‡¶∞ ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡¶æ‡¶≤‡ßü</div>
                    <h1 id="outShop">‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶®‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</h1>
                    <span id="outEstd" class="estd-text"></span>
                    <p id="outAddr">‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ ‡¶ì ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞</p>
                    <div class="contact-info">
                        <span id="outEmail"></span>
                        <span id="outWeb"></span>
                    </div>
                </div>
            </div>
            <div style="width:90px;"></div>
        </div>
        
        <div class="meta-section" id="metaSection">
            <div class="meta-dak">
                <span class="meta-label">‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡¶ï ‡¶®‡¶Ç:</span> 
                <span class="meta-value" id="outDak">..............</span>
            </div>
            <div class="meta-date">
                <span class="meta-label">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</span> 
                <span class="meta-value" id="outDateHeader">..............</span>
            </div>
        </div>
        
        <div class="body-content" id="bodyContent">
            <div class="title"><span id="titleText">‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡ßü‡¶® ‡¶™‡¶§‡ßç‡¶∞</span></div>
            
            <div id="mainContent" class="content">
                <p>‡¶è‡¶á ‡¶Æ‡¶∞‡ßç‡¶Æ‡ßá ‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡ßü‡¶® ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡ßá ‡¶Ø‡ßá, <span id="outName" class="data-text">..............</span>, ‡¶™‡¶ø‡¶§‡¶æ- <span id="outFather" class="data-text">..............</span>, ‡¶Æ‡¶æ‡¶§‡¶æ- <span id="outMother" class="data-text">..............</span>, ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ- <span id="outVill" class="data-text">..............</span>, ‡¶°‡¶æ‡¶ï‡¶ò‡¶∞- ‡¶∂‡¶æ‡¶π‡¶ú‡¶æ‡¶¶‡¶™‡ßÅ‡¶∞, ‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ- <span id="outUpz" class="data-text">..............</span>, ‡¶ú‡ßá‡¶≤‡¶æ- <span id="outDist" class="data-text">..............</span>‡•§ ‡¶∏‡ßá ‡¶è‡¶á ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶®‡ßá‡¶∞ <span id="outSession" class="data-text">..............</span> ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶¨‡¶∞‡ßç‡¶∑‡ßá‡¶∞ <span id="outDept" class="data-text">..............</span> <span id="outCls" class="data-text">..............</span> ‡¶è‡¶ï‡¶ú‡¶® ‡¶®‡¶ø‡ßü‡¶Æ‡¶ø‡¶§ ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶∞‡ßç‡¶•‡ßÄ‡•§ ‡¶§‡¶æ‡¶∞ ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶∞‡ßã‡¶≤- <span id="outRoll" class="data-text">.........</span>‡•§ ‡¶ú‡¶®‡ßç‡¶Æ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ- <span id="outDOB" class="data-text">..................</span> ‡¶ñ‡ßç‡¶∞‡¶ø.‡•§ ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ú‡¶æ‡¶®‡¶æ‡¶Æ‡¶§‡ßá ‡¶§‡¶æ‡¶∞ ‡¶∏‡ßç‡¶¨‡¶≠‡¶æ‡¶¨ ‡¶ö‡¶∞‡¶ø‡¶§‡ßç‡¶∞ ‡¶≠‡¶æ‡¶≤‡ßã ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßá ‡¶ï‡¶ñ‡¶®‡¶ì ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶®‡ßá‡¶∞ ‡¶∂‡ßÉ‡¶ô‡ßç‡¶ñ‡¶≤‡¶æ ‡¶¨‡¶ø‡¶∞‡ßã‡¶ß‡ßÄ ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡¶ï‡ßç‡¶∞‡¶Æ‡ßá ‡¶Ö‡¶Ç‡¶∂‡¶ó‡ßç‡¶∞‡¶π‡¶£ ‡¶ï‡¶∞‡ßá‡¶®‡¶ø‡•§</p>
                
                <p>‡¶Ü‡¶Æ‡¶ø ‡¶§‡¶æ‡¶∞ ‡¶ú‡ßÄ‡¶¨‡¶®‡ßá‡¶∞ ‡¶∏‡¶∞‡ßç‡¶¨‡¶æ‡¶ô‡ßç‡¶ó‡ßÄ‡¶® ‡¶â‡¶®‡ßç‡¶®‡¶§‡¶ø ‡¶ì ‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤ ‡¶ï‡¶æ‡¶Æ‡¶®‡¶æ ‡¶ï‡¶∞‡¶ø‡•§</p>
            </div>
            
            <!-- ‡¶Ü‡¶™‡¶°‡ßá‡¶ü‡ßá‡¶° ‡¶´‡ßÅ‡¶ü‡¶æ‡¶∞ - ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶æ‡¶ï‡¶ö‡¶æ‡¶∞ -->
            <div class="footer">
                <div id="outDate">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: </div>
                <div class="signature-block">
                    <div class="signature-line"></div>
                    <div class="teacher-name" id="outTeacherName">(‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ)</div>
                    <div class="teacher-title" id="outTeacherTitle">‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï</div>
                    <div class="school-name-footer" id="outSchoolNameFooter">‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶®‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</div>
                    <div class="school-address-footer" id="outSchoolAddressFooter">‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ</div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const KEY = 'bcti_class_fix_v70';
    let savedPass = "";
    let originalContentHTML = "";

    function toBengaliNumber(n) {
        const banglaDigits = {'0':'‡ß¶','1':'‡ßß','2':'‡ß®','3':'‡ß©','4':'‡ß™','5':'‡ß´','6':'‡ß¨','7':'‡ß≠','8':'‡ßÆ','9':'‡ßØ'};
        return n.toString().split('').map(digit => banglaDigits[digit] || digit).join('');
    }

    function setTodayDateBengali() {
        const today = new Date();
        const d = String(today.getDate()).padStart(2, '0');
        const m = String(today.getMonth() + 1).padStart(2, '0');
        const y = today.getFullYear();
        const bengaliDate = `${toBengaliNumber(d)}/${toBengaliNumber(m)}/${toBengaliNumber(y)} ‡¶ñ‡ßç‡¶∞‡¶ø.`;
        
        document.getElementById('outDate').innerText = `‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: ${bengaliDate}`;
        document.getElementById('outDateHeader').innerText = bengaliDate;
    }

    function toggleSettings() { 
        const ms = document.getElementById('masterSettings'); 
        ms.style.display = (ms.style.display === 'block') ? 'none' : 'block'; 
    }

    function checkPass() {
        if (!savedPass) { toggleSettings(); return; }
        const input = prompt("‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®:");
        if (input === savedPass) toggleSettings();
        else if (input !== null) alert("‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°!");
    }

    function updateFontFamily(fontValue) {
        document.getElementById('certArea').style.fontFamily = fontValue;
        save();
    }

    function updateShopSize(val) {
        document.getElementById('shopSizeValue').textContent = val + 'px';
        document.getElementById('outShop').style.fontSize = val + 'px';
    }

    function updateOfficeNameSize(val) {
        document.getElementById('officeNameValue').textContent = val + 'px';
        document.getElementById('outOfficeName').style.fontSize = val + 'px';
    }

    function updateAddressSize(val) {
        document.getElementById('addressSizeValue').textContent = val + 'px';
        document.getElementById('outAddr').style.fontSize = val + 'px';
    }

    function updateDateSize(val) {
        document.getElementById('dateSizeValue').textContent = val + 'px';
        document.getElementById('outDate').style.fontSize = val + 'px';
    }

    function updateTitleSize(val) {
        document.getElementById('titleSizeValue').textContent = val + 'px';
        document.getElementById('titleText').style.fontSize = val + 'px';
    }

    function updateLineGap(val) {
        document.getElementById('lineGapValue').textContent = val;
        document.getElementById('mainContent').style.lineHeight = val;
        save();
    }

    function updateHeaderLineGap(val) {
        document.getElementById('headerLineGapValue').textContent = val;
        document.getElementById('headerLines').style.lineHeight = val;
        save();
    }

    function updateHeaderMargin(val) {
        document.getElementById('headerTopValue').textContent = val + 'px';
        document.getElementById('headerSection').style.marginTop = val + 'px';
    }

    function updateMetaMargin(val) {
        document.getElementById('metaTopValue').textContent = val + 'px';
        document.getElementById('metaSection').style.marginTop = val + 'px';
    }

    function updateMetaFontSize(val) {
        document.getElementById('metaFontValue').textContent = val + 'px';
        document.getElementById('metaSection').style.fontSize = val + 'px';
    }

    function updateBodyMargin(val) {
        document.getElementById('bodyTopValue').textContent = val + 'px';
        document.getElementById('bodyContent').style.marginTop = val + 'px';
    }

    function updateMasterLists() {
        ['Upz', 'Dist', 'Session', 'Cls'].forEach(type => {
            const listEl = document.getElementById('set' + type);
            if(listEl) {
                const selectEl = document.getElementById('in' + type);
                const items = listEl.value.split(',').map(i => i.trim()).filter(i => i);
                selectEl.innerHTML = items.map(i => `<option value="${i}">${i}</option>`).join('');
            }
        });
        
        sync();
    }

    function sync() {
        const signTitle = document.getElementById('inSignTitle').value || "‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï";
        document.getElementById('outOfficeName').innerText = signTitle + "‡ßá‡¶∞ ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡¶æ‡¶≤‡ßü";
        document.getElementById('outTeacherTitle').innerText = signTitle;
        
        // ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
        const teacherName = document.getElementById('inTeacherName').value;
        document.getElementById('outTeacherName').innerText = teacherName ? teacherName : "(‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ)";
        
        document.getElementById('outShop').innerText = document.getElementById('inShop').value || "‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶®‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ";
        document.getElementById('outEstd').innerText = document.getElementById('inEstd').value || "";
        document.getElementById('outAddr').innerText = document.getElementById('inAddr').value || "‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ ‡¶ì ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞";
        document.getElementById('outEmail').innerText = document.getElementById('inEmail').value || "";
        document.getElementById('outWeb').innerText = document.getElementById('inWeb').value || "";
        document.getElementById('outDak').innerText = document.getElementById('inDak').value || "..............";
        document.getElementById('outName').innerText = document.getElementById('inName').value || "..............";
        document.getElementById('outFather').innerText = document.getElementById('inFather').value || "..............";
        document.getElementById('outMother').innerText = document.getElementById('inMother').value || "..............";
        document.getElementById('outVill').innerText = document.getElementById('inVill').value || "..............";
        document.getElementById('outUpz').innerText = document.getElementById('inUpz').value || "..............";
        document.getElementById('outDist').innerText = document.getElementById('inDist').value || "..............";
        document.getElementById('outSession').innerText = document.getElementById('inSession').value || "..............";
        
        // ‡¶´‡ßÅ‡¶ü‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∏‡ßç‡¶ï‡ßÅ‡¶≤‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶ì ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
        document.getElementById('outSchoolNameFooter').innerText = document.getElementById('inShop').value || "‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶®‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ";
        document.getElementById('outSchoolAddressFooter').innerText = document.getElementById('inAddr').value || "‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ";
        
        // ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶è‡¶¨‡¶Ç ‡¶∂‡¶æ‡¶ñ‡¶æ ‡¶π‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶≤‡¶ø‡¶Ç
        const clsVal = document.getElementById('inCls').value || "";
        const deptValue = document.getElementById('inDept').value || "";
        
        let className = clsVal;
        let section = "";
        
        if (clsVal.includes('-')) {
            const parts = clsVal.split('-');
            className = parts[0];
            section = parts[1];
        }
        
        // ‡ß¨‡¶∑‡ßç‡¶†-‡ßÆ‡¶Æ ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ‡¶§‡ßá ‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá ‡¶®‡¶æ ‡¶è‡¶¨‡¶Ç "‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ‡¶∞" ‡¶∂‡¶¨‡ßç‡¶¶‡¶ü‡¶ø‡¶ì ‡¶•‡¶æ‡¶ï‡¶¨‡ßá ‡¶®‡¶æ
        if (className.includes('‡ß¨‡¶∑‡ßç‡¶†') || className.includes('‡ß≠‡¶Æ') || className.includes('‡ßÆ‡¶Æ')) {
            document.getElementById('outDept').innerText = "";
            if (section) {
                document.getElementById('outCls').innerText = className + " ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ " + section + " ‡¶∂‡¶æ‡¶ñ‡¶æ‡¶∞";
            } else {
                document.getElementById('outCls').innerText = className + " ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ‡¶∞";
            }
        } else {
            document.getElementById('outDept').innerText = deptValue || "..............";
            document.getElementById('outCls').innerText = className + " ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ‡¶∞";
        }
        
        document.getElementById('outRoll').innerText = document.getElementById('inRoll').value || ".........";
        document.getElementById('outDOB').innerText = document.getElementById('inDOB').value || "..................";

        updateStyling();
        setTodayDateBengali();
        save();
    }

    function updateStyling() {
        const main = document.getElementById('mainContent');
        main.style.fontSize = document.getElementById('setFontSize').value + 'px';
        main.style.lineHeight = document.getElementById('lineGap').value;
        
        document.getElementById('headerLines').style.lineHeight = document.getElementById('headerLineGap').value;
        
        const indentVal = document.getElementById('setIndent').value + 'px';
        const paras = main.getElementsByTagName('p');
        for(let p of paras) { p.style.textIndent = indentVal; }

        const cert = document.getElementById('certArea');
        cert.style.padding = `${document.getElementById('mTop').value}px ${document.getElementById('mRight').value}px ${document.getElementById('mBottom').value}px ${document.getElementById('mLeft').value}px`;
        cert.classList.toggle('pad-mode-on', document.getElementById('padMode').checked);
        
        document.getElementById('outAddr').style.fontSize = document.getElementById('addressSize').value + 'px';
        document.getElementById('outDate').style.fontSize = document.getElementById('dateSize').value + 'px';
        document.getElementById('outOfficeName').style.fontSize = document.getElementById('officeNameSize').value + 'px';
        document.getElementById('titleText').style.fontSize = document.getElementById('titleSize').value + 'px';
        
        // ‡¶´‡ßÅ‡¶ü‡¶æ‡¶∞‡ßá‡¶∞ ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú
        const signSize = parseInt(document.getElementById('setSignSize').value);
        document.getElementById('outTeacherName').style.fontSize = signSize + 'px';
        document.getElementById('outTeacherTitle').style.fontSize = (signSize - 2) + 'px';
        document.getElementById('outSchoolNameFooter').style.fontSize = (signSize - 3) + 'px';
        document.getElementById('outSchoolAddressFooter').style.fontSize = (signSize - 4) + 'px';
        
        const fontFamily = document.getElementById('fontFamily');
        if (fontFamily && fontFamily.value) {
            cert.style.fontFamily = fontFamily.value;
        }
        
        updateHeaderMargin(document.getElementById('headerTopMargin').value);
        updateMetaMargin(document.getElementById('metaTopMargin').value);
        updateMetaFontSize(document.getElementById('metaFontSize').value);
        updateBodyMargin(document.getElementById('bodyTopMargin').value);
    }

    function updateLogo(input) {
        if (input.files && input.files[0]) {
            const r = new FileReader(); 
            r.onload = (e) => { 
                document.getElementById('certLogo').src = e.target.result; 
                save(); 
            }; 
            r.readAsDataURL(input.files[0]);
        }
    }

    function exportJSON() {
        const data = localStorage.getItem(KEY);
        if(!data) return alert("‡¶ï‡ßã‡¶®‡ßã ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡ßá‡¶á!");
        const a = document.createElement('a');
        a.href = URL.createObjectURL(new Blob([data], {type: "application/json"}));
        a.download = `BCTI_Backup_${new Date().toISOString().slice(0,10)}.json`; 
        a.click();
    }

    function importJSON(input) {
        const reader = new FileReader();
        reader.onload = (e) => { 
            localStorage.setItem(KEY, e.target.result); 
            location.reload(); 
        };
        reader.readAsText(input.files[0]);
    }

    function save() {
        const d = {};
        const fields = ['SignTitle', 'TeacherName', 'Shop','Estd','Addr','Email','Web','Dak','Name','Father','Mother','Vill','Upz','Dist','Session','Dept','Cls','Roll','DOB','setUpz','setDist','setSession','setDept','setCls','setFontSize','lineGap','headerLineGap','setIndent','setSignSize','mTop','mBottom','mLeft','mRight','setPass','shopNameSize','officeNameSize','addressSize','dateSize','titleSize','fontFamily','headerTopMargin','metaTopMargin','metaFontSize','bodyTopMargin'];
        
        fields.forEach(f => {
            const el = document.getElementById(f) || document.getElementById('in'+f);
            if(el) d[f] = el.value;
        });
        d.logo = document.getElementById('certLogo').src;
        d.pad = document.getElementById('padMode').checked;
        localStorage.setItem(KEY, JSON.stringify(d));
    }

    function autoLoad() {
        const s = localStorage.getItem(KEY);
        if(s) {
            const d = JSON.parse(s);
            Object.keys(d).forEach(k => {
                const el = document.getElementById(k) || document.getElementById('in'+k);
                if(el && k !== 'logo' && k !== 'pad') el.value = d[k];
            });
            if(d.logo) document.getElementById('certLogo').src = d.logo;
            document.getElementById('padMode').checked = d.pad || false;
            savedPass = d.setPass || "";
            
            if(d.shopNameSize) {
                document.getElementById('shopNameSize').value = d.shopNameSize;
                updateShopSize(d.shopNameSize);
            }
            if(d.officeNameSize) {
                document.getElementById('officeNameSize').value = d.officeNameSize;
                updateOfficeNameSize(d.officeNameSize);
            }
            if(d.addressSize) {
                document.getElementById('addressSize').value = d.addressSize;
                updateAddressSize(d.addressSize);
            }
            if(d.dateSize) {
                document.getElementById('dateSize').value = d.dateSize;
                updateDateSize(d.dateSize);
            }
            if(d.titleSize) {
                document.getElementById('titleSize').value = d.titleSize;
                updateTitleSize(d.titleSize);
            }
            if(d.lineGap) {
                document.getElementById('lineGap').value = d.lineGap;
                updateLineGap(d.lineGap);
            }
            if(d.headerLineGap) {
                document.getElementById('headerLineGap').value = d.headerLineGap;
                updateHeaderLineGap(d.headerLineGap);
            }
            if(d.fontFamily) {
                document.getElementById('fontFamily').value = d.fontFamily;
                updateFontFamily(d.fontFamily);
            }
            
            if(d.headerTopMargin) {
                document.getElementById('headerTopMargin').value = d.headerTopMargin;
                updateHeaderMargin(d.headerTopMargin);
            }
            if(d.metaTopMargin) {
                document.getElementById('metaTopMargin').value = d.metaTopMargin;
                updateMetaMargin(d.metaTopMargin);
            }
            if(d.metaFontSize) {
                document.getElementById('metaFontSize').value = d.metaFontSize;
                updateMetaFontSize(d.metaFontSize);
            }
            if(d.bodyTopMargin) {
                document.getElementById('bodyTopMargin').value = d.bodyTopMargin;
                updateBodyMargin(d.bodyTopMargin);
            }
        }
        
        setTodayDateBengali();
        updateMasterLists();
    }

    // ‡¶´‡ßã‡¶∞‡ßç‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü - ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá
    setInterval(function() {
        const clsVal = document.getElementById('inCls').value || "";
        const deptVal = document.getElementById('inDept').value || "";
        
        let className = clsVal;
        let section = "";
        
        if (clsVal.includes('-')) {
            const parts = clsVal.split('-');
            className = parts[0];
            section = parts[1];
        }
        
        const outCls = document.getElementById('outCls');
        const outDept = document.getElementById('outDept');
        
        if (className.includes('‡ß¨‡¶∑‡ßç‡¶†') || className.includes('‡ß≠‡¶Æ') || className.includes('‡ßÆ‡¶Æ')) {
            if (outDept) outDept.innerText = "";
            if (outCls) {
                if (section) {
                    outCls.innerText = className + " ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ " + section + " ‡¶∂‡¶æ‡¶ñ‡¶æ‡¶∞";
                } else {
                    outCls.innerText = className + " ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ‡¶∞";
                }
            }
        } else {
            if (outDept) outDept.innerText = deptVal || "..............";
            if (outCls) outCls.innerText = className + " ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ‡¶∞";
        }
        
        const outUpz = document.getElementById('outUpz');
        const upzVal = document.getElementById('inUpz').value;
        if (outUpz && outUpz.innerText !== upzVal) {
            outUpz.innerText = upzVal || "..............";
        }
        
        const outDist = document.getElementById('outDist');
        const distVal = document.getElementById('inDist').value;
        if (outDist && outDist.innerText !== distVal) {
            outDist.innerText = distVal || "..............";
        }
        
        const outSession = document.getElementById('outSession');
        const sessionVal = document.getElementById('inSession').value;
        if (outSession && outSession.innerText !== sessionVal) {
            outSession.innerText = sessionVal || "..............";
        }
        
        // ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
        const teacherName = document.getElementById('inTeacherName').value;
        const outTeacherName = document.getElementById('outTeacherName');
        if (outTeacherName) {
            outTeacherName.innerText = teacherName ? teacherName : "(‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ)";
        }
        
        // ‡¶´‡ßÅ‡¶ü‡¶æ‡¶∞‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
        document.getElementById('outTeacherTitle').innerText = document.getElementById('inSignTitle').value || "‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï";
        document.getElementById('outSchoolNameFooter').innerText = document.getElementById('inShop').value || "‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶®‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ";
        document.getElementById('outSchoolAddressFooter').innerText = document.getElementById('inAddr').value || "‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ";
    }, 500);
</script>
</body>
</html>